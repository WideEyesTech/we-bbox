var Bbox=function(t){function e(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var r=a(3),i=n(r),o=a(1),s=n(o),u=void 0,h=function(t){function e(t){function e(){M.innerHTML="",B.dispose&&B.dispose(),W.dispose&&W.dispose(),u=null}function a(t){p=t}function n(t){t.preventDefault(),_.style.zIndex=10,w=x(t,_);var e=void 0;return e=R.isEditPoint(w)?o:R.isInside(w)?h:d,i["default"].Observable.fromEvent(M,"mousemove").map(e).takeUntil(i["default"].Observable.fromEvent(M,"mouseup"))}function r(t){if(w=x(t),R.hasBbox()&&p){var e=R.getOrigin(),a=R.getFinal();p({x1:Math.round(e.x/k),y1:Math.round(e.y/k),x2:Math.round(a.x/k),y2:Math.round(a.y/k)})}return i["default"].Observable.fromEvent(M,"mousemove").takeUntil(i["default"].Observable.fromEvent(M,"mousedown"))}function o(t){var e=v(w,t);return w=x(t),{type:"resize",data:{origin:w,delta:e}}}function h(t){var e=v(w,t);return w=x(t),{type:"move",data:e}}function d(t){var e=f(w,t);return{type:"draw",data:e}}function l(t){switch(t.type){case"draw":R.draw(t.data.origin,t.data.width,t.data.height);break;case"move":R.move(t.data);break;case"resize":R.resize(t.data.origin,t.data.delta)}}function c(t){var e=x(t,M);if(R.isEditPoint(e)){var a=R.getEditPoint(e);_.style.cursor=a.style}else R.isInside(e)&&"move"!==_.style.cursor?_.style.cursor="move":R.isInside(e)||"crosshair"===_.style.cursor||(_.style.cursor="crosshair")}function y(t,e){var a=document.createElement("img");return k=e/t.width,a.src=t.src,a.width=t.width*k,a.height=t.height*k,{newImage:a,ratio:k}}function f(t,e){var a=v(t,e);return{origin:t,height:a.y,width:a.x}}function x(t){return m=_.getBoundingClientRect(),{x:Math.round(t.clientX-m.left),y:Math.round(t.clientY-m.top)}}function v(t,e){return m=_.getBoundingClientRect(),{x:Math.round(e.clientX-m.left-t.x),y:Math.round(e.clientY-m.top-t.y)}}var M=t.canvasContainer,b=t.img,m=void 0,g=void 0,p=void 0,w={x:0,y:0},k=1,E=b.width,z=M.offsetWidth;if(E>z){var O=y(b,z);g=O.newImage}else g=b;var I=document.createElement("canvas");I.width=Math.floor(g.width)-1,I.height=Math.floor(g.height)-1;var P=I.getContext("2d");P.drawImage(g,0,0,Math.floor(g.width),Math.floor(g.height));var _=document.createElement("canvas");_.width=Math.floor(g.width)-1,_.height=Math.floor(g.height)-1,_.style.position="absolute",_.style.left=0,_.style.cursor="crosshair",_.setAttribute("id","the_canvas");var C=document.createElement("div");C.style.height=_.height,C.style.margin="0 auto",C.style.position="relative",C.style.width=_.width;var R=(0,s["default"])({canvas:_});C.appendChild(I),C.appendChild(_),M.appendChild(C);var B=i["default"].Observable.fromEvent(_,"mousedown").flatMap(n).subscribe(l),W=i["default"].Observable.fromEvent(M,"mouseup").flatMap(r).subscribe(c);return i["default"].Observable.fromEvent(M,"mousemove").takeUntil(i["default"].Observable.fromEvent(M,"mousedown")).subscribe(c),{canvas:_,dispose:e,subscribe:a}}return u||(u=e(t)),u};t.exports=h},function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t){function e(t){function e(){return I}function a(){return O}function n(){return Math.abs(P)>10&&Math.abs(_)>10}function r(t){var e=5,a=m.filter(function(a){return t.x>a.x-e&&t.x<a.x+e&&t.y>a.y-e&&t.y<a.y+e});return g=a[0]}function i(t){var e=5,a=m.filter(function(a){return t.x>a.x-e&&t.x<a.x+e&&t.y>a.y-e&&t.y<a.y+e});return a.length>0}function s(t){return t.x>Math.min(M.x,b.x)&&t.x<Math.max(M.x,b.x)&&t.y>Math.min(M.y,b.y)&&t.y<Math.max(M.y,b.y)}function u(t,e){switch(g.id){case 0:M=t,_=Math.round(Math.abs(_)-e.y),P=Math.round(Math.abs(P)-e.x);break;case 1:M={x:O.x,y:O.y+e.y},_=Math.round(Math.abs(_)-e.y),P=Math.abs(P);break;case 2:M=t,_=Math.round(Math.abs(_)-e.y),P=Math.round(-1*Math.abs(P)-e.x);break;case 3:M=O,_=Math.abs(_),P=Math.round(Math.abs(P)+e.x);break;case 4:M=t,_=Math.round(-1*Math.abs(_)-e.y),P=Math.round(-1*Math.abs(P)-e.x);break;case 5:M=O,_=Math.round(Math.abs(_)+e.y),P=Math.abs(P);break;case 6:M=t,_=Math.round(-1*Math.abs(_)-e.y),P=Math.round(Math.abs(P)-e.x);break;case 7:M={x:O.x+e.x,y:O.y},_=Math.abs(_),P=Math.round(Math.abs(P)-e.x)}b=f(M,P,_),c()}function h(t){M={x:M.x+t.x,y:M.y+t.y},b=f(M,P,_),c()}function d(t,e,a){M=t,_=a,P=e,b=f(M,P,_),c()}function l(){P=0,_=0,M={x:0,y:0},b={x:0,y:0},c()}function c(){m=[],k.globalAlpha=p,k.fillStyle="black",k.clearRect(0,0,w.width,w.height),k.fillRect(0,0,w.width,w.height),P&&_&&(k.clearRect(M.x,M.y,P,_),O=x(),I=v(),m.push(y({x:O.x,y:O.y},0,"nwse-resize")),m.push(y({x:I.x,y:O.y},2,"nesw-resize")),m.push(y({x:I.x,y:I.y},4,"nwse-resize")),m.push(y({x:O.x,y:I.y},6,"nesw-resize")),m.push(y({x:I.x-Math.abs(P)/2,y:O.y},1,"ns-resize")),m.push(y({x:I.x,y:I.y-Math.abs(_)/2},3,"ew-resize")),m.push(y({x:I.x-Math.abs(P)/2,y:I.y},5,"ns-resize")),m.push(y({x:O.x,y:I.y-Math.abs(_)/2},7,"ew-resize")))}function y(t,e,a){return(0,o["default"])({origin:t,id:e,style:a}).draw(k)}function f(t,e,a){return{x:Math.round(t.x+e),y:Math.round(t.y+a)}}function x(){return{x:Math.max(Math.min(M.x,b.x),0),y:Math.max(Math.min(M.y,b.y),0)}}function v(){return{x:Math.min(Math.max(M.x,b.x),w.width),y:Math.min(Math.max(M.y,b.y),w.height)}}var M=void 0,b=void 0,m=[],g={},p=.3,w=t.canvas,k=w.getContext("2d"),E=w.width,z=w.height,O=M={x:E/3,y:z/3},I=b={x:2*E/3,y:2*z/3},P=I.x-O.x,_=I.y-O.y;return c(),{draw:d,getEditPoint:r,getFinal:e,getOrigin:a,hasBbox:n,isEditPoint:i,isInside:s,move:h,reset:l,resize:u}}return e(t)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var i=a(2),o=n(i)},function(t,e){"use strict";function a(t){function e(t){return t.save(),t.globalAlpha=1,t.fillStyle=n.colors.background,t.strokeStyle=n.colors.stroke,t.lineWidth=n.lineWidth,t.beginPath(),t.arc(a.x,a.y,n.width/2,2*Math.PI,!1),t.stroke(),t.fill(),t.restore(),o}var a=t.origin,r=t.id,i=t.style,o={draw:e,id:r,style:i,x:a.x,y:a.y};return o}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=a;var n={colors:{background:"#333",stroke:"white"},lineWidth:3,width:8}},function(t,e){t.exports=Rx}]);